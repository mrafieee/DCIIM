(function(a){a.fn.formset=function(b){var j=a.extend({},a.fn.formset.defaults,b);var i=function(n,o,l){var k=new RegExp("("+o+"-(\\d+|__prefix__))");var m=o+"-"+l;if(a(n).attr("for")){a(n).attr("for",a(n).attr("for").replace(k,m))}if(n.id){n.id=n.id.replace(k,m)}if(n.name){n.name=n.name.replace(k,m)}};var d=a("#id_"+j.prefix+"-TOTAL_FORMS").attr("autocomplete","off");var e=parseInt(d.val());var g=a("#id_"+j.prefix+"-MAX_NUM_FORMS").attr("autocomplete","off");var h=g.val()==""||(g.val()-d.val())>0;a(this).each(function(k){a(this).not("."+j.emptyCssClass).addClass(j.formCssClass)});if(a(this).length&&h){var f;if(a(this).attr("tagName")=="TR"){var c=this.eq(0).children().length;a(this).parent().append('<tr class="'+j.addCssClass+'"><td colspan="'+c+'"><a href="javascript:void(0)">'+j.addText+"</a></tr>");f=a(this).parent().find("tr:last a")}else{a(this).filter(":last").after('<div class="'+j.addCssClass+'"><a href="javascript:void(0)">'+j.addText+"</a></div>");f=a(this).filter(":last").next().find("a")}f.click(function(){var l=a("#id_"+j.prefix+"-TOTAL_FORMS");var k=a("#"+j.prefix+"-empty");var m=k.clone(true);m.removeClass(j.emptyCssClass).addClass(j.formCssClass).attr("id",j.prefix+"-"+e);if(m.is("tr")){m.children(":last").append('<div><a class="'+j.deleteCssClass+'" href="javascript:void(0)">'+j.deleteText+"</a></div>")}else{if(m.is("ul")||m.is("ol")){m.append('<li><a class="'+j.deleteCssClass+'" href="javascript:void(0)">'+j.deleteText+"</a></li>")}else{m.children(":first").append('<span><a class="'+j.deleteCssClass+'" href="javascript:void(0)">'+j.deleteText+"</a></span>")}}m.find("*").each(function(){i(this,j.prefix,l.val())});m.insertBefore(a(k));a(l).val(parseInt(l.val())+1);e+=1;if((g.val()!="")&&(g.val()-l.val())<=0){f.parent().hide()}m.find("a."+j.deleteCssClass).click(function(){var q=a(this).parents("."+j.formCssClass);q.remove();e-=1;if(j.removed){j.removed(q)}var n=a("."+j.formCssClass);a("#id_"+j.prefix+"-TOTAL_FORMS").val(n.length);if((g.val()=="")||(g.val()-n.length)>0){f.parent().show()}for(var o=0,p=n.length;o<p;o++){i(a(n).get(o),j.prefix,o);a(n.get(o)).find("*").each(function(){i(this,j.prefix,o)})}return false});if(j.added){j.added(m)}return false})}return this};a.fn.formset.defaults={prefix:"form",addText:"add another",deleteText:"remove",addCssClass:"add-row",deleteCssClass:"delete-row",emptyCssClass:"empty-row",formCssClass:"dynamic-form",added:null,removed:null}})(django.jQuery);