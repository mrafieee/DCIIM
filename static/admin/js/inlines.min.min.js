(function(b){b.fn.formset=function(r){var a=b.extend({},b.fn.formset.defaults,r);var k=function(g,f,d){var e=new RegExp("("+f+"-(\\d+|__prefix__))");var c=f+"-"+d;if(b(g).attr("for")){b(g).attr("for",b(g).attr("for").replace(e,c))}if(g.id){g.id=g.id.replace(e,c)}if(g.name){g.name=g.name.replace(e,c)}};var p=b("#id_"+a.prefix+"-TOTAL_FORMS").attr("autocomplete","off");var o=parseInt(p.val());var m=b("#id_"+a.prefix+"-MAX_NUM_FORMS").attr("autocomplete","off");var l=m.val()==""||(m.val()-p.val())>0;b(this).each(function(c){b(this).not("."+a.emptyCssClass).addClass(a.formCssClass)});if(b(this).length&&l){var n;if(b(this).attr("tagName")=="TR"){var q=this.eq(0).children().length;b(this).parent().append('<tr class="'+a.addCssClass+'"><td colspan="'+q+'"><a href="javascript:void(0)">'+a.addText+"</a></tr>");n=b(this).parent().find("tr:last a")}else{b(this).filter(":last").after('<div class="'+a.addCssClass+'"><a href="javascript:void(0)">'+a.addText+"</a></div>");n=b(this).filter(":last").next().find("a")}n.click(function(){var d=b("#id_"+a.prefix+"-TOTAL_FORMS");var e=b("#"+a.prefix+"-empty");var c=e.clone(true);c.removeClass(a.emptyCssClass).addClass(a.formCssClass).attr("id",a.prefix+"-"+o);if(c.is("tr")){c.children(":last").append('<div><a class="'+a.deleteCssClass+'" href="javascript:void(0)">'+a.deleteText+"</a></div>")}else{if(c.is("ul")||c.is("ol")){c.append('<li><a class="'+a.deleteCssClass+'" href="javascript:void(0)">'+a.deleteText+"</a></li>")}else{c.children(":first").append('<span><a class="'+a.deleteCssClass+'" href="javascript:void(0)">'+a.deleteText+"</a></span>")}}c.find("*").each(function(){k(this,a.prefix,d.val())});c.insertBefore(b(e));b(d).val(parseInt(d.val())+1);o+=1;if((m.val()!="")&&(m.val()-d.val())<=0){n.parent().hide()}c.find("a."+a.deleteCssClass).click(function(){var f=b(this).parents("."+a.formCssClass);f.remove();o-=1;if(a.removed){a.removed(f)}var i=b("."+a.formCssClass);b("#id_"+a.prefix+"-TOTAL_FORMS").val(i.length);if((m.val()=="")||(m.val()-i.length)>0){n.parent().show()}for(var h=0,g=i.length;h<g;h++){k(b(i).get(h),a.prefix,h);b(i.get(h)).find("*").each(function(){k(this,a.prefix,h)})}return false});if(a.added){a.added(c)}return false})}return this};b.fn.formset.defaults={prefix:"form",addText:"add another",deleteText:"remove",addCssClass:"add-row",deleteCssClass:"delete-row",emptyCssClass:"empty-row",formCssClass:"dynamic-form",added:null,removed:null}})(django.jQuery);